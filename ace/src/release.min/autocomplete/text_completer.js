var Range=require("../range").Range,splitRegex=/[^a-zA-Z_0-9\$\-\u00C0-\u1FFF\u2C00-\uD7FF\w]+/;function getWordIndex(e,t){return e.getTextRange(Range.fromPoints({row:0,column:0},t)).split(splitRegex).length-1}function wordDistance(e,t){var n=getWordIndex(e,t),a=e.getValue().split(splitRegex),r=Object.create(null),o=a[n];return a.forEach(function(e,t){e&&e!==o&&(t=Math.abs(n-t),t=a.length-t,r[e]?r[e]=Math.max(t,r[e]):r[e]=t)}),r}exports.getCompletions=function(e,t,n,a,r){var o=wordDistance(t,n);r(null,Object.keys(o).map(function(e){return{caption:e,value:e,score:o[e],meta:"local"}}))};