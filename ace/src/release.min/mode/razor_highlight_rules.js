"use strict";var oop=require("../lib/oop"),lang=require("../lib/lang"),DocCommentHighlightRules=require("./doc_comment_highlight_rules").DocCommentHighlightRules,HtmlHighlightRules=require("./html_highlight_rules").HtmlHighlightRules,CSharpHighlightRules=require("./csharp_highlight_rules").CSharpHighlightRules,blockPrefix="razor-block-",RazorLangHighlightRules=function(){CSharpHighlightRules.call(this);var e="in-braces",h=(this.$rules.start.unshift({regex:"[\\[({]",onMatch:function(t,i,r){i=/razor-[^\-]+-/.exec(i)[0];return r.unshift(t),r.unshift(i+e),this.next=i+e,"paren.lparen"}},{start:"@\\*",end:"\\*@",token:"comment"}),{"{":"}","[":"]","(":")"});this.$rules[e]=lang.deepCopy(this.$rules.start),this.$rules[e].unshift({regex:"[\\])}]",onMatch:function(t,i,r){var e=r[1];return h[e]!==t?"invalid.illegal":(r.shift(),r.shift(),this.next=(e=t,("function"==typeof(t=r[0])?t(e):t)||"start"),"paren.rparen")}})},RazorHighlightRules=(oop.inherits(RazorLangHighlightRules,CSharpHighlightRules),function(){HtmlHighlightRules.call(this);var t,h={"@{":"}","@(":")","@functions{":"}"},i={regex:"[})]",onMatch:function(t,i,r){var e=r[1];return h[e]!==t?"invalid.illegal":(r.shift(),r.shift(),this.next=r.shift()||"start","punctuation.block.razor")}},r=[{start:"@\\*",end:"\\*@",token:"comment"},{token:["meta.directive.razor","text","identifier"],regex:"^(\\s*@model)(\\s+)(.+)$"},{regex:"@[({]|@functions{",onMatch:function(t,i,r){return r.unshift(t),r.unshift("razor-block-start"),this.next="razor-block-start","punctuation.block.razor"}},{regex:"@(?![{(])",onMatch:function(t,i,r){return r.unshift("razor-short-start"),this.next="razor-short-start","punctuation.short.razor"}}];for(t in this.$rules)this.$rules[t].unshift.apply(this.$rules[t],r);this.embedRules(RazorLangHighlightRules,"razor-block-",[i],["start"]),this.embedRules(RazorLangHighlightRules,"razor-short-",[{token:"",regex:"(?=[^A-Za-z_\\.()\\[\\]])",next:"pop"}],["start"]),this.normalizeRules()});oop.inherits(RazorHighlightRules,HtmlHighlightRules),exports.RazorHighlightRules=RazorHighlightRules,exports.RazorLangHighlightRules=RazorLangHighlightRules;