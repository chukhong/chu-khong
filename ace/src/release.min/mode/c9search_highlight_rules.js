"use strict";var oop=require("../lib/oop"),lang=require("../lib/lang"),TextHighlightRules=require("./text_highlight_rules").TextHighlightRules;function safeCreateRegexp(e,t){try{return new RegExp(e,t)}catch(e){}}var C9SearchHighlightRules=function(){this.$rules={start:[{tokenNames:["c9searchresults.constant.numeric","c9searchresults.text","c9searchresults.text","c9searchresults.keyword"],regex:/(^\s+[0-9]+)(:)(\d*\s?)([^\r\n]+)/,onMatch:function(e,t,s){var r,e=this.splitRegex.exec(e),u=this.tokenNames,a=[{type:u[0],value:e[1]},{type:u[1],value:e[2]}],l=(e[3]&&(" "==e[3]?a[1]={type:u[1],value:e[2]+" "}:a.push({type:u[1],value:e[3]})),s[1]),n=e[4],i=0;if(l&&l.exec)for(l.lastIndex=0;r=l.exec(n);){var h=n.substring(i,r.index),i=l.lastIndex;if(h&&a.push({type:u[2],value:h}),r[0])a.push({type:u[3],value:r[0]});else if(!h)break}return i<n.length&&a.push({type:u[2],value:n.substr(i)}),a}},{regex:"^Searching for [^\\r\\n]*$",onMatch:function(e,t,s){var r,u=e.split("");if(u.length<3)return"text";var a=0,l=[{value:u[a++]+"'",type:"text"},{value:e=u[a++],type:"text"},{value:"'"+u[a++],type:"text"}];for(" in"!==u[2]&&l.push({value:"'"+u[a++]+"'",type:"text"},{value:u[a++],type:"text"}),l.push({value:" "+u[a++]+" ",type:"text"}),u[a+1]?(r=u[a+1],l.push({value:"("+u[a+1]+")",type:"text"}),a+=1):--a;a++<u.length;)u[a]&&l.push({value:u[a],type:"text"});e=(e=e&&(/regex/.test(r)||(e=lang.escapeRegExp(e)),/whole/.test(r))?"\\b"+e+"\\b":e)&&safeCreateRegexp("("+e+")",/ sensitive/.test(r)?"g":"ig");return e&&(s[0]=t,s[1]=e),l}},{regex:"^(?=Found \\d+ matches)",token:"text",next:"numbers"},{token:"string",regex:"^\\S:?[^:]+",next:"numbers"}],numbers:[{regex:"\\d+",token:"constant.numeric"},{regex:"$",token:"text",next:"start"}]},this.normalizeRules()};oop.inherits(C9SearchHighlightRules,TextHighlightRules),exports.C9SearchHighlightRules=C9SearchHighlightRules;