"use strict";var oop=require("../lib/oop"),TextMode=require("./text").Mode,PhpHighlightRules=require("./php_highlight_rules").PhpHighlightRules,PhpLangHighlightRules=require("./php_highlight_rules").PhpLangHighlightRules,MatchingBraceOutdent=require("./matching_brace_outdent").MatchingBraceOutdent,Range=require("../range").Range,WorkerClient=require("../worker/worker_client").WorkerClient,PhpCompletions=require("./php_completions").PhpCompletions,CstyleBehaviour=require("./behaviour/cstyle").CstyleBehaviour,CStyleFoldMode=require("./folding/cstyle").FoldMode,unicode=require("../unicode"),HtmlMode=require("./html").Mode,JavaScriptMode=require("./javascript").Mode,CssMode=require("./css").Mode,PhpMode=function(e){this.HighlightRules=PhpLangHighlightRules,this.$outdent=new MatchingBraceOutdent,this.$behaviour=new CstyleBehaviour,this.$completer=new PhpCompletions,this.foldingRules=new CStyleFoldMode},Mode=(oop.inherits(PhpMode,TextMode),!function(){this.tokenRe=new RegExp("^["+unicode.wordChars+"_]+","g"),this.nonTokenRe=new RegExp("^(?:[^"+unicode.wordChars+"_]|\\s])+","g"),this.lineCommentStart=["//","#"],this.blockComment={start:"/*",end:"*/"},this.getNextLineIndent=function(e,t,i){var o,n=this.$getIndent(t),r=this.getTokenizer().getLineTokens(t,e),h=r.tokens,r=r.state;if(!h.length||"comment"!=h[h.length-1].type)if("start"==e)(o=t.match(/^.*[\{\(\[:]\s*$/))&&(n+=i);else if("doc-start"==e){if("doc-start"!=r)return"";(o=t.match(/^\s*(\/?)\*/))&&(o[1]&&(n+=" "),n+="* ")}return n},this.checkOutdent=function(e,t,i){return this.$outdent.checkOutdent(t,i)},this.autoOutdent=function(e,t,i){this.$outdent.autoOutdent(t,i)},this.getCompletions=function(e,t,i,o){return this.$completer.getCompletions(e,t,i,o)},this.$id="ace/mode/php-inline"}.call(PhpMode.prototype),function(e){if(e&&e.inline)return(e=new PhpMode).createWorker=this.createWorker,e.inlinePhp=!0,e;HtmlMode.call(this),this.HighlightRules=PhpHighlightRules,this.createModeDelegates({"js-":JavaScriptMode,"css-":CssMode,"php-":PhpMode}),this.foldingRules.subModes["php-"]=new CStyleFoldMode});oop.inherits(Mode,HtmlMode),function(){this.createWorker=function(t){var e=new WorkerClient(["ace"],"ace/mode/php_worker","PhpWorker");return e.attachToDocument(t.getDocument()),this.inlinePhp&&e.call("setOptions",[{inline:!0}]),e.on("annotate",function(e){t.setAnnotations(e.data)}),e.on("terminate",function(){t.clearAnnotations()}),e},this.$id="ace/mode/php",this.snippetFileId="ace/snippets/php"}.call(Mode.prototype),exports.Mode=Mode;