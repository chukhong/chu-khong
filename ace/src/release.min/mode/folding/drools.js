"use strict";var oop=require("../../lib/oop"),Range=require("../../range").Range,BaseFoldMode=require("./fold_mode").FoldMode,TokenIterator=require("../../token_iterator").TokenIterator,FoldMode=exports.FoldMode=function(){};oop.inherits(FoldMode,BaseFoldMode),function(){this.foldingStartMarker=/\b(rule|declare|query|when|then)\b/,this.foldingStopMarker=/\bend\b/,this.getFoldWidgetRange=function(e,o,r){var t=e.getLine(r),n=t.match(this.foldingStartMarker);if(n){n.index;if(n[1]){var d={row:r,column:t.length},i=new TokenIterator(e,d.row,d.column),a="end",l=i.getCurrentToken();for("when"==l.value&&(a="then");l;){if(l.value==a)return Range.fromPoints(d,{row:i.getCurrentTokenRow(),column:i.getCurrentTokenColumn()});l=i.stepForward()}}}}}.call(FoldMode.prototype);