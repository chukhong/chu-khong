"undefined"!=typeof process&&require("amd-loader");var LineWidgets=require("./line_widgets").LineWidgets,EditSession=require("./edit_session").EditSession,assert=require("./test/assertions"),Range=require("./range").Range;module.exports={createSession:function(e,o){o=new Array(o+1).join("a"),e=new Array(e).join(o+"\n")+o;return new EditSession(e)},"test: selectAll":function(){var e=this.createSession(10,10),o=e.selection;e.selection.selectAll(),assert.position(o.getAnchor(),0,0),assert.position(o.getCursor(),9,10),assert.position(o.getRange().end,9,10),assert.position(o.getRange().start,0,0)},"test: move cursor to end of file should place the cursor on last row and column":function(){var e=this.createSession(200,10).getSelection();e.moveCursorFileEnd(),assert.position(e.getCursor(),199,10)},"test: moveCursor to start of file should place the cursor on the first row and column":function(){var e=this.createSession(200,10).getSelection();e.moveCursorFileStart(),assert.position(e.getCursor(),0,0)},"test: move selection lead to end of file":function(){var e=this.createSession(200,10).getSelection(),e=(e.moveCursorTo(100,5),e.selectFileEnd(),e.getRange());assert.position(e.start,100,5),assert.position(e.end,199,10)},"test: move selection lead to start of file":function(){var e=this.createSession(200,10).getSelection(),e=(e.moveCursorTo(100,5),e.selectFileStart(),e.getRange());assert.position(e.start,0,0),assert.position(e.end,100,5)},"test: move cursor word right":function(){var e=new EditSession(["ab"," Juhu Kinners (abc, 12)"," cde"].join("\n")),o=e.getSelection();e.$selectLongWords=!0,o.moveCursorDown(),assert.position(o.getCursor(),1,0),o.moveCursorWordRight(),assert.position(o.getCursor(),1,5),o.moveCursorWordRight(),assert.position(o.getCursor(),1,13),o.moveCursorWordRight(),assert.position(o.getCursor(),1,18),o.moveCursorWordRight(),assert.position(o.getCursor(),1,22),o.moveCursorWordRight(),assert.position(o.getCursor(),2,4),o.moveCursorWordRight(),assert.position(o.getCursor(),2,4)},"test: select word right if cursor in word":function(){var e=new EditSession("Juhu Kinners").getSelection();e.moveCursorTo(0,2),e.moveCursorWordRight(),assert.position(e.getCursor(),0,4)},"test: moveCursor word left":function(){var e=new EditSession(["ab"," Juhu Kinners (abc, 12)"," cde"].join("\n")),o=e.getSelection();e.$selectLongWords=!0,o.moveCursorDown(),o.moveCursorLineEnd(),assert.position(o.getCursor(),1,23),o.moveCursorWordLeft(),assert.position(o.getCursor(),1,20),o.moveCursorWordLeft(),assert.position(o.getCursor(),1,15),o.moveCursorWordLeft(),assert.position(o.getCursor(),1,6),o.moveCursorWordLeft(),assert.position(o.getCursor(),1,1),o.moveCursorWordLeft(),assert.position(o.getCursor(),0,0),o.moveCursorWordLeft(),assert.position(o.getCursor(),0,0)},"test: moveCursor word left with umlauts":function(){var e=new EditSession(" Fuß Füße"),e=(e.$selectLongWords=!0,e.getSelection());e.moveCursorTo(0,9),e.moveCursorWordLeft(),assert.position(e.getCursor(),0,5),e.moveCursorWordLeft(),assert.position(e.getCursor(),0,1)},"test: select word left if cursor in word":function(){var e=new EditSession("Juhu Kinners"),o=e.getSelection();e.$selectLongWords=!0,o.moveCursorTo(0,8),o.moveCursorWordLeft(),assert.position(o.getCursor(),0,5)},"test: select word right and select":function(){var e=new EditSession("Juhu Kinners").getSelection(),e=(e.moveCursorTo(0,0),e.selectWordRight(),e.getRange());assert.position(e.start,0,0),assert.position(e.end,0,4)},"test: select word left and select":function(){var e=new EditSession("Juhu Kinners").getSelection(),e=(e.moveCursorTo(0,3),e.selectWordLeft(),e.getRange());assert.position(e.start,0,0),assert.position(e.end,0,3)},"test: select word with cursor in word should select the word":function(){var e=new EditSession("Juhu Kinners 123").getSelection(),e=(e.moveCursorTo(0,8),e.selectWord(),e.getRange());assert.position(e.start,0,5),assert.position(e.end,0,12)},"test: select word with cursor in word including right whitespace should select the word":function(){var e=new EditSession("Juhu Kinners      123").getSelection(),e=(e.moveCursorTo(0,8),e.selectAWord(),e.getRange());assert.position(e.start,0,5),assert.position(e.end,0,18)},"test: select word with cursor betwen white space and word should select the word":function(){var e=new EditSession("Juhu Kinners"),o=e.getSelection(),e=(e.$selectLongWords=!0,o.moveCursorTo(0,4),o.selectWord(),o.getRange()),e=(assert.position(e.start,0,0),assert.position(e.end,0,4),o.moveCursorTo(0,5),o.selectWord(),o.getRange());assert.position(e.start,0,5),assert.position(e.end,0,12)},"test: select word with cursor in white space should select white space":function(){var e=new EditSession("Juhu  Kinners"),o=e.getSelection(),e=(e.$selectLongWords=!0,o.moveCursorTo(0,5),o.selectWord(),o.getRange());assert.position(e.start,0,4),assert.position(e.end,0,6)},"test: moving cursor should fire a 'changeCursor' event":function(){var e=new EditSession("Juhu  Kinners"),o=e.getSelection(),t=(e.$selectLongWords=!0,o.moveCursorTo(0,5),!1);o.addEventListener("changeCursor",function(){t=!0}),o.moveCursorTo(0,6),assert.ok(t)},"test: calling setCursor with the same position should not fire an event":function(){var e=new EditSession("Juhu  Kinners"),o=e.getSelection(),t=(e.$selectLongWords=!0,o.moveCursorTo(0,5),!1);o.addEventListener("changeCursor",function(){t=!0}),o.moveCursorTo(0,5),assert.notOk(t)},"test: moveWordright should move past || and [":function(){var e=new EditSession("||foo["),o=e.getSelection();e.$selectLongWords=!0,o.moveCursorWordRight(),assert.position(o.getCursor(),0,5),o.moveCursorWordRight(),assert.position(o.getCursor(),0,6)},"test: moveWordLeft should move past || and [":function(){var e=new EditSession("||foo["),o=e.getSelection();e.$selectLongWords=!0,o.moveCursorTo(0,6),o.moveCursorWordLeft(),assert.position(o.getCursor(),0,2),o.moveCursorWordLeft(),assert.position(o.getCursor(),0,0)},"test: move cursor to line start should move cursor to end of the indentation first":function(){var e=new EditSession("12\n    Juhu\n12").getSelection();e.moveCursorTo(1,6),e.moveCursorLineStart(),assert.position(e.getCursor(),1,4)},"test: move cursor to line start when the cursor is at the end of the indentation should move cursor to column 0":function(){var e=new EditSession("12\n    Juhu\n12").getSelection();e.moveCursorTo(1,4),e.moveCursorLineStart(),assert.position(e.getCursor(),1,0)},"test: move cursor to line start when the cursor is at column 0 should move cursor to the end of the indentation":function(){var e=new EditSession("12\n    Juhu\n12").getSelection();e.moveCursorTo(1,0),e.moveCursorLineStart(),assert.position(e.getCursor(),1,4)},"test: move cursor to line start when the cursor is before the initial indentation should move cursor to the end of the indentation":function(){var e=new EditSession("12\n    Juhu\n12").getSelection();e.moveCursorTo(1,2),e.moveCursorLineStart(),assert.position(e.getCursor(),1,4)},"test go line up when in the middle of the first line should go to document start":function(){var e=new EditSession("juhu kinners").getSelection();e.moveCursorTo(0,4),e.moveCursorUp(),assert.position(e.getCursor(),0,0)},"test: (wrap) go line up when in the middle of the first line should go to document start":function(){var e=new EditSession("juhu kinners"),e=(e.setWrapLimitRange(5,5),e.adjustWrapLimit(80),e.getSelection());e.moveCursorTo(0,4),e.moveCursorUp(),assert.position(e.getCursor(),0,0)},"test go line down when in the middle of the last line should go to document end":function(){var e=new EditSession("juhu kinners").getSelection();e.moveCursorTo(0,4),e.moveCursorDown(),assert.position(e.getCursor(),0,12)},"test (wrap) go line down when in the middle of the last line should go to document end":function(){var e=new EditSession("juhu kinners"),e=(e.setWrapLimitRange(8,8),e.adjustWrapLimit(80),e.getSelection());e.moveCursorTo(0,10),e.moveCursorDown(),assert.position(e.getCursor(),0,12)},"test go line up twice and then once down when in the second should go back to the previous column":function(){var e=new EditSession("juhu\nkinners").getSelection();e.moveCursorTo(1,4),e.moveCursorUp(),e.moveCursorUp(),e.moveCursorDown(),assert.position(e.getCursor(),1,4)},"test (keyboard navigation) when curLine is not EOL and targetLine is all whitespace new column should be current column":function(){var e=new EditSession("function (a) {\n    \n}").getSelection();e.moveCursorTo(2,0),e.moveCursorUp(),assert.position(e.getCursor(),1,0)},"test (keyboard navigation) when curLine is EOL and targetLine is shorter than current column, new column should be targetLine's EOL":function(){var e=new EditSession("function (a) {\n    \n}").getSelection();e.moveCursorTo(0,14),e.moveCursorDown(),assert.position(e.getCursor(),1,4)},"test fromJSON/toJSON":function(){function e(e){return JSON.parse(JSON.stringify(e))}var o=new EditSession("function (a) {\n    \n}").getSelection(),t=(o.moveCursorTo(0,14),o.moveCursorDown(),assert.position(o.getCursor(),1,4),o.toJSON()),s=(o.moveCursorDown(),assert.position(o.getCursor(),2,1),assert.ok(!o.isEqual(t)),0),r=0;o.on("changeCursor",function(){s++}),o.on("changeSelection",function(){r++}),o.fromJSON(e(t)),assert.equal(s,1),assert.equal(r,1),assert.position(o.getCursor(),1,4),assert.ok(o.isEqual(t)),t.end.column=10,o.fromJSON(e(t)),assert.equal(s,1),assert.equal(r,1),t.end.column=4,assert.ok(o.isEqual(t)),t.start.row=0,o.fromJSON(e(t)),assert.equal(s,1),assert.equal(r,2),assert.ok(o.isEqual(t)),t.isBackwards=!0,o.fromJSON(e(t)),assert.equal(s,2),assert.equal(r,3),assert.ok(o.isEqual(t)),o.moveTo(0,0),s=r=0,o.selectAll(),assert.equal(s,1),assert.equal(r,1),o.moveCursorRight(),o.clearSelection(),s=r=0,o.selectAll(),assert.equal(s,0),assert.equal(r,1)},"test setRange inside fold":function(){var e=new EditSession("-\n-fold-\n-"),o=e.getSelection();e.addFold(".",new Range(0,1,2,0)),o.setRange(new Range(1,1,1,5)),assert.equal(e.getTextRange(),"fold")},"test navigate around line widgets":function(){var e=new EditSession(["a","b","","c","d"]),o=(e.widgetManager=new LineWidgets(e),e.getSelection());e.widgetManager.addLineWidget({row:0,rowCount:5,rowsAbove:2}),e.widgetManager.addLineWidget({row:1,rowCount:3,rowsAbove:1}),e.widgetManager.addLineWidget({row:3,rowCount:4}),assert.position(e.documentToScreenPosition(3,1),11,1),e.selection.moveCursorLineEnd(),e.selection.moveCursorUp(),assert.position(o.cursor,0,0),e.selection.moveCursorDown(),assert.position(o.cursor,1,1),e.selection.moveCursorDown(),assert.position(o.cursor,2,0),e.selection.moveCursorDown(),assert.position(o.cursor,3,1),e.selection.moveCursorUp(),assert.position(o.cursor,2,0),e.selection.moveCursorUp(),assert.position(o.cursor,1,1)},"test selectLine":function(){var e=new EditSession("   text  -\n-fold-   \n-").getSelection();e.selectLine(),assert.range(e.getRange(),0,0,1,0),e.clearSelection(),assert.position(e.getAnchor(),1,0),e.moveCursorLineEnd(),assert.position(e.getAnchor(),1,9),e.moveCursorLineEnd(),assert.position(e.getAnchor(),1,6),e.selectLineStart(),assert.range(e.getRange(),1,0,1,6)}},"undefined"!=typeof module&&module===require.main&&require("asyncjs").test.testcase(module.exports).exec();