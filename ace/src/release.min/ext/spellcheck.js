"use strict";var event=require("../lib/event"),Editor=(exports.contextMenuHandler=function(e){var n,s,i,r=e.target,o=r.textInput.getElement();r.selection.isEmpty()&&(e=r.getCursorPosition(),n=r.session.getWordRange(e.row,e.column),e=r.session.getTextRange(n),r.session.tokenRe.lastIndex=0,r.session.tokenRe.test(e))&&(o.value=s=e+" ",o.setSelectionRange(e.length,e.length+1),o.setSelectionRange(0,0),o.setSelectionRange(0,e.length),i=!1,event.addListener(o,"keydown",function e(){event.removeListener(o,"keydown",e),i=!0}),r.textInput.setInputHandler(function(e){if(e==s)return"";if(0===e.lastIndexOf(s,0))return e.slice(s.length);if(e.substr(o.selectionEnd)==s)return e.slice(0,-s.length);if(""==e.slice(-2)){var t=e.slice(0,-2);if(" "==t.slice(-1))return i?t.substring(0,o.selectionEnd):(t=t.slice(0,-1),r.session.replace(n,t),"")}return e}))},require("../editor").Editor);require("../config").defineOptions(Editor.prototype,"editor",{spellcheck:{set:function(e){this.textInput.getElement().spellcheck=!!e,e?this.on("nativecontextmenu",exports.contextMenuHandler):this.removeListener("nativecontextmenu",exports.contextMenuHandler)},value:!0}});