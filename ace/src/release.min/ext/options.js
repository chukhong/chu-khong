"use strict";require("./menu_tools/overlay_page");var dom=require("../lib/dom"),oop=require("../lib/oop"),config=require("../config"),EventEmitter=require("../lib/event_emitter").EventEmitter,buildDom=dom.buildDom,modelist=require("./modelist"),themelist=require("./themelist"),themes={Bright:[],Dark:[]},modes=(themelist.themes.forEach(function(e){themes[e.isDark?"Dark":"Bright"].push({caption:e.caption,value:e.theme})}),modelist.modes.map(function(e){return{caption:e.caption,value:e.mode}})),optionGroups={Main:{Mode:{path:"mode",type:"select",items:modes},Theme:{path:"theme",type:"select",items:themes},Keybinding:{type:"buttonBar",path:"keyboardHandler",items:[{caption:"Ace",value:null},{caption:"Vim",value:"ace/keyboard/vim"},{caption:"Emacs",value:"ace/keyboard/emacs"},{caption:"Sublime",value:"ace/keyboard/sublime"},{caption:"VSCode",value:"ace/keyboard/vscode"}]},"Font Size":{path:"fontSize",type:"number",defaultValue:12,defaults:[{caption:"12px",value:12},{caption:"24px",value:24}]},"Soft Wrap":{type:"buttonBar",path:"wrap",items:[{caption:"Off",value:"off"},{caption:"View",value:"free"},{caption:"margin",value:"printMargin"},{caption:"40",value:"40"}]},"Cursor Style":{path:"cursorStyle",items:[{caption:"Ace",value:"ace"},{caption:"Slim",value:"slim"},{caption:"Smooth",value:"smooth"},{caption:"Smooth And Slim",value:"smooth slim"},{caption:"Wide",value:"wide"}]},Folding:{path:"foldStyle",items:[{caption:"Manual",value:"manual"},{caption:"Mark begin",value:"markbegin"},{caption:"Mark begin and end",value:"markbeginend"}]},"Soft Tabs":[{path:"useSoftTabs"},{ariaLabel:"Tab Size",path:"tabSize",type:"number",values:[2,3,4,8,16]}],Overscroll:{type:"buttonBar",path:"scrollPastEnd",items:[{caption:"None",value:0},{caption:"Half",value:.5},{caption:"Full",value:1}]}},More:{"Atomic soft tabs":{path:"navigateWithinSoftTabs"},"Enable Behaviours":{path:"behavioursEnabled"},"Wrap with quotes":{path:"wrapBehavioursEnabled"},"Enable Auto Indent":{path:"enableAutoIndent"},"Full Line Selection":{type:"checkbox",values:"text|line",path:"selectionStyle"},"Highlight Active Line":{path:"highlightActiveLine"},"Show Invisibles":{path:"showInvisibles"},"Show Indent Guides":{path:"displayIndentGuides"},"Persistent HScrollbar":{path:"hScrollBarAlwaysVisible"},"Persistent VScrollbar":{path:"vScrollBarAlwaysVisible"},"Animate scrolling":{path:"animatedScroll"},"Show Gutter":{path:"showGutter"},"Show Line Numbers":{path:"showLineNumbers"},"Relative Line Numbers":{path:"relativeLineNumbers"},"Fixed Gutter Width":{path:"fixedWidthGutter"},"Show Print Margin":[{path:"showPrintMargin"},{ariaLabel:"Print Margin",type:"number",path:"printMarginColumn"}],"Indented Soft Wrap":{path:"indentedSoftWrap"},"Highlight selected word":{path:"highlightSelectedWord"},"Fade Fold Widgets":{path:"fadeFoldWidgets"},"Use textarea for IME":{path:"useTextareaForIME"},"Merge Undo Deltas":{path:"mergeUndoDeltas",items:[{caption:"Always",value:"always"},{caption:"Never",value:"false"},{caption:"Timed",value:"true"}]},"Elastic Tabstops":{path:"useElasticTabstops"},"Incremental Search":{path:"useIncrementalSearch"},"Read-only":{path:"readOnly"},"Copy without selection":{path:"copyWithEmptySelection"},"Live Autocompletion":{path:"enableLiveAutocompletion"}}},OptionPanel=function(e,t){this.editor=e,this.container=t||document.createElement("div"),this.groups=[],this.options={}};!function(){oop.implement(this,EventEmitter),this.add=function(e){e.Main&&oop.mixin(optionGroups.Main,e.Main),e.More&&oop.mixin(optionGroups.More,e.More)},this.render=function(){this.container.innerHTML="",buildDom(["table",{role:"presentation",id:"controls"},this.renderOptionGroup(optionGroups.Main),["tr",null,["td",{colspan:2},["table",{role:"presentation",id:"more-controls"},this.renderOptionGroup(optionGroups.More)]]],["tr",null,["td",{colspan:2},"version "+config.version]]],this.container)},this.renderOptionGroup=function(a){return Object.keys(a).map(function(e,t){var i=a[e];return i.position||(i.position=t/1e4),i.label||(i.label=e),i}).sort(function(e,t){return e.position-t.position}).map(function(e){return this.renderOption(e.label,e)},this)},this.renderOptionControl=function(t,a){var e,i,n,o,r=this;return Array.isArray(a)?a.map(function(e){return r.renderOptionControl(t,e)}):(e=r.getOption(a),a.values&&"checkbox"!=a.type&&("string"==typeof a.values&&(a.values=a.values.split("|")),a.items=a.values.map(function(e){return{value:e,name:e}})),"buttonBar"==a.type?o=["div",{role:"group","aria-labelledby":a.path+"-label"},a.items.map(function(i){return["button",{value:i.value,ace_selected_button:e==i.value,"aria-pressed":e==i.value,onclick:function(){r.setOption(a,i.value);for(var e=this.parentNode.querySelectorAll("[ace_selected_button]"),t=0;t<e.length;t++)e[t].removeAttribute("ace_selected_button"),e[t].setAttribute("aria-pressed",!1);this.setAttribute("ace_selected_button",!0),this.setAttribute("aria-pressed",!0)}},i.desc||i.caption||i.name]})]:"number"==a.type?(o=["input",{type:"number",value:e||a.defaultValue,style:"width:3em",oninput:function(){r.setOption(a,parseInt(this.value))}}],a.ariaLabel?o[1]["aria-label"]=a.ariaLabel:o[1].id=t,a.defaults&&(o=[o,a.defaults.map(function(t){return["button",{onclick:function(){var e=this.parentNode.firstChild;e.value=t.value,e.oninput()}},t.caption]})])):a.items?(i=function(e){return e.map(function(e){return["option",{value:e.value||e.name},e.desc||e.caption||e.name]})},n=Array.isArray(a.items)?i(a.items):Object.keys(a.items).map(function(e){return["optgroup",{label:e},i(a.items[e])]}),o=["select",{id:t,value:e,onchange:function(){r.setOption(a,this.value)}},n]):("string"==typeof a.values&&(a.values=a.values.split("|")),a.values&&(e=e==a.values[1]),o=["input",{type:"checkbox",id:t,checked:e||null,onchange:function(){var e=this.checked;a.values&&(e=a.values[e?1:0]),r.setOption(a,e)}}],"checkedNumber"==a.type&&(o=[o,[]])),o)},this.renderOption=function(e,t){var i,a;if(!t.path||t.onchange||this.editor.$options[t.path])return i=(Array.isArray(t)?t[0]:t).path,this.options[i]=t,["tr",{class:"ace_optionsMenuEntry"},["td",["label",{for:a="-"+i,id:i+"-label"},e]],["td",this.renderOptionControl(a,t)]]},this.setOption=function(e,t){"string"==typeof e&&(e=this.options[e]),"string"==typeof(t="undefined"==(t="null"==(t="true"==(t="false"==t?!1:t)?!0:t)?null:t)?void 0:t)&&parseFloat(t).toString()==t&&(t=parseFloat(t)),e.onchange?e.onchange(t):e.path&&this.editor.setOption(e.path,t),this._signal("setOption",{name:e.path,value:t})},this.getOption=function(e){return e.getValue?e.getValue():this.editor.getOption(e.path)}}.call(OptionPanel.prototype),exports.OptionPanel=OptionPanel;