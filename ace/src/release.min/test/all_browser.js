"use strict";require("ace/lib/fixoldbrowsers");var i,mockdom=require("../test/mockdom"),AsyncTest=require("asyncjs").test,async=require("asyncjs"),passed=0,failed=0,log=document.getElementById("log"),el=document.createElement.bind(document),testNames=["ace/ace_test","ace/anchor_test","ace/autocomplete_test","ace/background_tokenizer_test","ace/commands/command_manager_test","ace/config_test","ace/document_test","ace/edit_session_test","ace/editor_change_document_test","ace/editor_highlight_selected_word_test","ace/editor_navigation_test","ace/editor_text_edit_test","ace/editor_commands_test","ace/ext/hardwrap_test","ace/ext/static_highlight_test","ace/ext/whitespace_test","ace/ext/error_marker_test","ace/ext/code_lens_test","ace/ext/beautify_test","ace/incremental_search_test","ace/keyboard/emacs_test","ace/keyboard/textinput_test","ace/keyboard/keybinding_test","ace/keyboard/vim_test","ace/keyboard/vim_ace_test","ace/keyboard/sublime_test","ace/layer/text_test","ace/lib/event_emitter_test","ace/mode/coffee/parser_test","ace/mode/coldfusion_test","ace/mode/css_test","ace/mode/css_worker","ace/mode/html_test","ace/mode/javascript_test","ace/mode/javascript_worker_test","ace/mode/logiql_test","ace/mode/python_test","ace/mode/text_test","ace/mode/xml_test","ace/mode/folding/fold_mode_test","ace/mode/folding/cstyle_test","ace/mode/folding/html_test","ace/mode/folding/pythonic_test","ace/mode/folding/xml_test","ace/mode/folding/coffee_test","ace/mode/behaviour/behaviour_test","ace/multi_select_test","ace/mouse/mouse_handler_test","ace/occur_test","ace/placeholder_test","ace/range_test","ace/range_list_test","ace/search_test","ace/selection_test","ace/snippets_test","ace/token_iterator_test","ace/tokenizer_test","ace/test/mockdom_test","ace/undomanager_test","ace/virtual_renderer_test","ace/mode/yaml_worker_test"],html=["<a href='?'>all tests</a><br>"];for(i in testNames){var href=testNames[i];html.push("<a href='?",href,"'>",href.replace(/^ace\//,""),"</a><br>")}var parts,nav=el("div"),filter=(nav.innerHTML=html.join(""),nav.style.cssText="position:absolute;right:0;top:0",document.body.appendChild(nav),-1!=location.search.indexOf("show=1")&&require(["ace/virtual_renderer","ace/test/mockrenderer"],function(e,t){var a=e.VirtualRenderer;t.MockRenderer=function(){var e=document.createElement("div");return e.style.position="fixed",e.style.left="20px",e.style.top="30px",e.style.width="500px",e.style.height="300px",document.body.appendChild(e),new a(e)}}),-1!=location.search.indexOf("mock=1")&&mockdom.loadInBrowser(window),location.search&&(parts=location.search.split(/[&?]|\w+=\w+/).filter(Boolean))[0]&&(testNames=parts[0].split(",")),location.hash.substr(1));window.onhashchange=function(){location.reload()},require(testNames,function(){var e=testNames.map(function(e){var t=require(e);return t.href=e,t});async.list(e).expand(function(t){return filter&&Object.keys(t).forEach(function(e){e.match(/^>?test/)&&!e.match(filter)&&(t[e]=void 0)}),AsyncTest.testcase(t)},AsyncTest.TestGenerator).run().each(function(e,t){1==e.index&&e.context.href&&(s=e.context.href,(a=el("div")).innerHTML="<a href='?"+s+"'>"+s.replace(/^ace\//,"")+"</a>",log.appendChild(a));var a=el("div"),s=(a.className=e.passed?"passed":"failed",e.name),s=(e.suiteName&&(s=e.suiteName+": "+e.name),"["+e.count+"/"+e.index+"] "+s+" "+(e.passed?"OK":"FAIL"));e.passed?console.log(s):(e=e.err.stack||e.err,console.error(s),console.error(e),s+="<pre class='error'>"+e+"</pre>"),a.innerHTML=s,log.appendChild(a),t()}).each(function(e){e.passed?passed+=1:failed+=1}).end(function(){log.innerHTML+=["<div class='summary'>","<br>","Summary: <br>","<br>","Total number of tests: "+(passed+failed)+"<br>",passed?"Passed tests: "+passed+"<br>":"",failed?"Failed tests: "+failed+"<br>":""].join(""),console.log("Total number of tests: "+(passed+failed)),console.log("Passed tests: "+passed),console.log("Failed tests: "+failed)})});