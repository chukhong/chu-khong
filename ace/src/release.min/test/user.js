"use strict";var keyCodeToKey={},keyCodeToCode={},alias={Ctrl:"Control",Option:"Alt"},controlKeys=(alias.Cmd=alias.Super=alias.Meta="Command",{Shift:16,Control:17,Alt:18,Meta:224,Command:224,Backspace:8,Tab:9,Return:13,Enter:13,Pause:19,Escape:27,PageUp:33,PageDown:34,End:35,Home:36,Left:37,Up:38,Right:39,Down:40,Insert:45,Delete:46,ArrowLeft:37,ArrowUp:38,ArrowRight:39,ArrowDown:40}),shiftedKeys={},printableKeys={},specialKeys={Backquote:[192,"`","~"],Minus:[189,"-","_"],Equal:[187,"=","+"],BracketLeft:[219,"[","{"],Backslash:[220,"\\","|"],BracketRight:[221,"]","}"],Semicolon:[186,";",":"],Quote:[222,"'",'"'],Comma:[188,",","<"],Period:[190,".",">"],Slash:[191,"/","?"],Space:[32," "],NumpadAdd:[107,"+"],NumpadDecimal:[110,"."],NumpadSubtract:[109,"-"],NumpadDivide:[111,"/"],NumpadMultiply:[106,"*"]};for(i in specialKeys){var key=specialKeys[i];printableKeys[i]=printableKeys[key[1]]=shiftedKeys[key[2]]=key[0],keyCodeToCode[key[0]]=i}for(var i=0;i<10;i++)printableKeys[i]=shiftedKeys["!@#$%^&*()"[i]]=48+i,keyCodeToCode[48+i]="Digit"+i;for(i=65;i<91;i++){var chr=String.fromCharCode(i+32);printableKeys[chr]=shiftedKeys[chr.toUpperCase()]=i,keyCodeToCode[i]="Key"+chr.toUpperCase()}for(i=1;i<13;i++)controlKeys["F"+i]=111+i;for(i in controlKeys)keyCodeToKey[controlKeys[i]]=i,keyCodeToCode[controlKeys[i]]=i;controlKeys["\n"]=controlKeys.Return;var shift=!1,ctrl=!1,meta=!1,alt=!1;function reset(){shift=ctrl=meta=alt=!1}function updateModifierStates(e){return e==controlKeys.Shift?shift=!0:e==controlKeys.Control?ctrl=!0:e==controlKeys.Meta?meta=!0:e==controlKeys.Alt?alt=!0:void 0}function sendKey(e,t){var n=controlKeys[e]||printableKeys[e]||shiftedKeys[e],o=updateModifierStates(n),l=e,y=(ctrl||alt||meta||controlKeys[e]?l="":shift&&(l=l.toUpperCase()),document.activeElement),e=c("keydown",!0);function c(e,t){t={bubbles:t,cancelable:!0},t.charCode=l.charCodeAt(0),t.keyCode="keypress"==e?t.charCode:n,t.which=t.keyCode,t.shiftKey=shift||shiftedKeys[l],t.ctrlKey=ctrl,t.altKey=alt,t.metaKey=meta,t.key=l||keyCodeToKey[n],t.code=keyCodeToCode[n],e=new KeyboardEvent(e,t);return document.activeElement.dispatchEvent(e),e.defaultPrevented}o||(l&&c("keypress",!0),e||function(){var e=y,t="selectionStart"in e&&"string"==typeof e.value,o=/text|true/.test(e.contentEditable);if(t||o){var i,t=e.selectionStart,r=e.selectionEnd,a=e.value;if(o&&(a=e.textContent,i=window.getSelection().getRangeAt(0),t=i.startOffset,r=i.endOffset),!l)if(13==n)l="\n";else if(8==n)t!=r&&(t=Math.max(t-1,0));else{if(46!=n)return;t!=r&&(r=Math.min(r+1,a.length))}var s=a.slice(0,t)+l+a.slice(r);t=r=t+l.length,s!=a&&(o?(e.textContent=s,i.setStart(e.firstChild,t),i.setEnd(e.firstChild,r)):(e.value=s,e.setSelectionRange(t,r)),c("input",!1))}}(),c("keyup",!0))}function type(){for(var e=Array.prototype.slice.call(arguments),t=0;t<e.length;t++){var o=e[t];if(Array.isArray(o))type.apply(null,o);else{if(reset(),1<o.length)if(!(controlKeys[o]||printableKeys[o]||shiftedKeys[o])){var i=o.split("-"),r=alias[i[0]]||i[0];if(!updateModifierStates(controlKeys[r])){type.apply(null,o.split(""));continue}o=i.pop(),i.forEach(function(e){updateModifierStates(controlKeys[e])})}sendKey(o)}}}exports.type=type;