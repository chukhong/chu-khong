"use strict";!function(){var t,e,d,a,l,o,n=require("data/hanNom")["hanNom"],s=require("data/hanViet")["hanViet"],r=require("data/gianPhonThe")["gianPhonThe"],i=(window.hanViet=s,require("ace/lib/dom").buildDom),{getSelection:g,setSelection:c,reSelected:h,getTextPreviousLine:x,titleCase:m,autoSpellCheck:u}=require("lib/utilities");window.getTextPreviousLine=x;function p(){e.saveButton.disabled=d.session.getUndoManager().isClean(),e.undoButton.disabled=!d.session.getUndoManager().hasUndo(),e.redoButton.disabled=!d.session.getUndoManager().hasRedo()}function C(){localStorage.savedValue=d.getValue(),d.session.getUndoManager().markClean(),p()}t=window.app,e=window.refs,(d=window.editor).on("input",p),d.commands.addCommand({name:"save",exec:C,bindKey:{win:"ctrl-s",mac:"cmd-s"}}),o={save:C,undo:()=>{d.undo()},redo:()=>{d.redo()},selectall:e=>{d.selectAll()},copy:()=>{a=d.getCopyText(),navigator.clipboard.writeText(a),d.onCopy()},cut:()=>{a=d.getCopyText(),navigator.clipboard.writeText(a),d.onCut()},paste:t=>{navigator.clipboard.readText().then(e=>d.onPaste(e,t))},search:()=>{console.log("search"),d.execCommand("find")},reply:()=>{d.execCommand("replace")},searchtu:e=>{searchInput.value=d.getCopyText(),0!=searchInput.value.length&&(btnSearchWord.click(),$("#dialogResultSearchWord").offcanvas("show"))},translateOffline:()=>{var e;navigator.onLine?(e=x(d),e=script_url+"?q="+JSON.stringify({SHEETNAME:SHEETNAME,action:"translate",data:{TEXT:e,USERID:USERID}}),fetch(e,{method:"GET",mode:"cors",headers:{"Content-Type":"text/plain;charset=utf-8"}}).then(e=>e.json()).then(e=>{"successful"==e.status&&(d.onPaste(e.message),console.log(e))})):t.toast.message("Alert","internet is off").show()},gTranslate:()=>{var e;navigator.onLine?(e=x(d),$("#iframeGT")[0].contentWindow.postMessage(e)):t.toast.message("Alert","internet is off").show()},upLowCases:()=>{var e=g(d),t=(o=l).toUpperCase(),a=m(o),n=o.toLowerCase(),o=o==t&&t[1]&&t[1]==o[1]?a:o==n?t:n;l=o,d.onPaste(o),c(d,e)},spellcheck:()=>{var e=l,t=g(d),e=u(e);d.onPaste(e),c(d,t)},linearWords:()=>{var e=g(d),t=l;l=-1==t.indexOf("-")?t.replace(/\s/g,"-"):t.replace(/\-/g," "),d.onPaste(l),c(d,e)},changeWords34:()=>{var e=g(d),t=l.split(" "),a=t[0];3==t.length&&(t[0]=t[2],t[2]=a,l=t.join(" ")),4==t.length&&(l=t[2]+" "+t[3]+" "+t[0]+" "+t[1]),5==t.length&&(l=t[3]+" "+t[4]+" "+t[2]+" "+t[0]+" "+t[1]),6==t.length&&(l=t[4]+" "+t[5]+" "+t[2]+" "+t[3]+" "+t[0]+" "+t[1]),d.onPaste(l),c(d,e)},changeWordscua:()=>{var e=g(d),t=l.split("của"),a=t[0].trim();t[0]=t[1].trim(),t[1]=a,l=t.join(" của "),d.onPaste(l),c(d,e)},changeWordsla:()=>{var e=g(d),t=l.split("là"),a=t[0].trim();t[0]=t[1].trim(),t[1]=a,l=t.join(" là "),d.onPaste(l),c(d,e)},hideBarExpand:()=>{o.nextCMD.barExpandShow&&$('[data-bs-target="#barExpand"')[0].click()},nextCMD:{index:null,text:"",data:null,target:"",barExpandShow:!1},selectWord:e=>{var t,{index:a,data:n}=o.nextCMD,e=$(e.target).html();null==n?(d.onPaste(e),o.hideBarExpand(),$("#dialogSelectWord").modal("hide"),t=g(d),c(d,t)):(o.nextCMD.text=o.nextCMD.text.replace(n[a],e),a>=n.length-1?(o.nextCMD.index=null,o.nextCMD.data=null,d.onPaste(o.nextCMD.text),o.nextCMD.text="",o.nextCMD.target="",o.hideBarExpand(),$("#dialogSelectWord").modal("hide")):(o.nextCMD.index++,setTimeout(()=>{$(o.nextCMD.target).click()},100)))},keyboardHanViet:()=>{null==o.nextCMD.data&&(o.nextCMD.target="[data-cmd-as='keyboardHanViet']",1<(a=(l=1!=(l=l||d.getSelectedText()).length&&0!=l.length?l:x(d)).split(/[\s\n]+/)).length)&&(o.nextCMD.data=a,o.nextCMD.index=0,o.nextCMD.text=l),a=o.nextCMD.index,t=Array.isArray(o.nextCMD.data)?o.nextCMD.data[a]:l,0!=(a=window.hanViet.filter(e=>-1!=e[1].split(/\,\s|\,|\;\s|\;/).indexOf(t))).length&&(e=(a=a.map(e=>e[0])).map(e=>["button",{class:"btn btn-secondary","data-cmd-as":"selectWord"},e])),0==a.length&&(e=(a=[t]).map(e=>["button",{class:"btn btn-secondary","data-cmd-as":"selectWord"},e])),$("#dialogSelectWord .modal-body").html("");var e,t,a=$("#dialogSelectWord .modal-body")[0];i(e,a,{}),$("#dialogSelectWord .modal-title").html(o.nextCMD.text),$("#dialogSelectWord").modal("show")},keyboardHanNom:()=>{null==o.nextCMD.data&&(o.nextCMD.target="[data-cmd-as='keyboardHanNom']",1<(a=(l=1!=(l=l||d.getSelectedText()).length&&0!=l.length?l:x(d)).split(/\s+/)).length)&&(o.nextCMD.data=a,o.nextCMD.index=0,o.nextCMD.text=l),a=o.nextCMD.index,t=Array.isArray(o.nextCMD.data)?o.nextCMD.data[a]:l,(a=n.find(e=>e[0]==t))&&(e=(a=a[1].split(/\,\s|\,|\;\s|\;/)).map(e=>["button",{class:"btn btn-secondary","data-cmd-as":"selectWord"},e])),a||(e=(a=[t]).map(e=>["button",{class:"btn btn-secondary","data-cmd-as":"selectWord"},e])),$("#dialogSelectWord .modal-body").html("");var e,t,a=$("#dialogSelectWord .modal-body")[0];i(e,a,{}),$("#dialogSelectWord .modal-title").html(o.nextCMD.text),$("#dialogSelectWord").modal("show")},keyboardPhiemAm:()=>{var e,t=!1;0==(l=l||d.getSelectedText()).length&&(l=x(d),t=!0),e=l,window.hanViet.sort((e,t)=>t[0].length-e[0].length),window.hanViet.map(e=>{var t=e[1].split(/\,\s|\,|\;\s|\;/);l=l.replace(new RegExp(e[0],"g"),t[0]+" ")}),e!=l&&(d.onPaste(l),0==t)&&h(d)},keyboardGianThe:()=>{for(var t,e,a=l=l||d.getSelectedText(),n=0;n<l.length;n++)t=l[n],(e=r.find(e=>e[1]==t))&&(l=l.replace(t,e[0]));a!=l&&(d.onPaste(l),h(d))},keyboardPhonThe:()=>{for(var t,e,a=l=l||d.getSelectedText(),n=0;n<l.length;n++)t=l[n],(e=r.find(e=>e[0]==t))&&(l=l.replace(t,e[1]));a!=l&&(d.onPaste(l),h(d))},userprofile:()=>{},insertEnter:()=>{d.onPaste("\n")},insertTab:()=>{d.onPaste("\t")},systemWord:()=>{},moveleft:()=>{var e=g(d);c(d,[e[0],e[1]-1])},moveright:()=>{var e=g(d);c(d,[e[0],e[1]+1])},dialogUser:()=>{},openFile:t.openFile},$(document).on("click","[data-cmd-as]",function(e){var t=$(this).data("cmdAs");o[t]?o[t](e):console.log(`
	        // ${t} not defined
	        ${t}:()=>{}
	    `)}),d.on("mouseup",function(){o.nextCMD={index:null,text:"",data:null,target:"",barExpandShow:!1};var e=d.getCopyText();d.selection,(l=e).length&&console.log(e),$("[class~=autoclick]")[0]&&$("[class~=autoclick]").click()}),$("[data-toggle='modal-contextmenu']").on("contextmenu",function(e){e.preventDefault();e=$(this).data("target");$(e).modal("show")}),$("[data-toggle='active']").on("contextmenu",function(e){var t=$(this).data("target");$(t).toggleClass("autoclick"),e.preventDefault()}),$("[data-toggle='modal-left-click']").on("click",function(e){e.preventDefault();e=$(this).data("target");$(e).modal("show")}),$("[data-toggle='toggle-find']").on("click",function(e){alert(e),$("[data-toggle='toggle-find']").each((e,t)=>{t=$(t).data("target");$(t).addClass("d-none")});e=$(this).data("target");$(e).toggleClass("d-none"),$("#dialogOptionFind").modal("hide")}),$("[data-toggle='toggle-keyboard']").on("click",function(e){$("[data-toggle='toggle-keyboard']").each((e,t)=>{t=$(t).data("target");$(t).addClass("d-none")});var t=$(this).data("target");$(t).toggleClass("d-none"),$("#dialogOptionKeyboard").modal("hide")}),$("[data-toggle='toggle-translate']").on("click",function(e){$("[data-toggle='toggle-translate']").each((e,t)=>{t=$(t).data("target");$(t).addClass("d-none")});var t=$(this).data("target");$(t).toggleClass("d-none"),$("#dialogOptionTranslate").modal("hide")}),$("[data-toggle='toggle-changeWords']").on("click",function(e){$("[data-toggle='toggle-changeWords']").each((e,t)=>{t=$(t).data("target");$(t).addClass("d-none")});var t=$(this).data("target");console.log(t),$(t).toggleClass("d-none"),$("#dialogOptionChangeWords").modal("hide")}),(s=document.getElementById("barExpand")).addEventListener("hidden.bs.offcanvas",e=>{o.nextCMD.barExpandShow=!1}),s.addEventListener("show.bs.offcanvas",e=>{o.nextCMD.barExpandShow=!0})}();